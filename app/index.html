<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>OpenSubtitles Uploader</title>
    <link rel="icon" type="image/png" href="images/os-icon.png"/>
    <link rel="stylesheet" type="text/css" href="css/main.css"/>
    <link rel="stylesheet" type="text/css" href="css/animations.css"/>

    <script src="js/vendor/jquery.js" type="application/javascript"></script>
    <script src="js/os.js" type="application/javascript"></script>
    <script src="js/interface.js" type="application/javascript"></script>
    <script src="js/misc.js" type="application/javascript"></script>
</head>

<body>
    <div id="drop-mask"></div>
    <section id="main-buttons">

        <div id="button-upload" onClick="opensubtitles.upload()" class="button dominant">Upload</div>

        <div id="authentication">
            <div id="logged" style="display:none">
                <div id="logged-as">Logged in as %username%</div>
                <div id="button-logout" onClick="opensubtitles.logout()" class="button light">log out</div>
            </div>
            <div id="not-logged" style="display:block">
                <input id="login-username" type="text" placeholder="username"></input>
                <input id="login-password" type="password" placeholder="password"></input>
                <div id="button-login" onClick="opensubtitles.login()" class="button light">login</div>
            </div>
        </div>

    </section>

    <section id="main-video" class="section-file">

        <div class="input-line">
            <span class="input-file">Video file</span>
            <input id="video-file-path" class="input-input" type="text" placeholder="Drop a video file or select one" readonly></input>
            <input id="video-file-path-hidden" style="display:none" type="file"></input>
            <div id="video-browser" onClick="interface.browse('video')" class="button light">browse</div>
        </div>

        <div class="metadata">
            <span class="title">Metadata</span>
            <div class="content col-left">
                <div class="metaitem">
                    <span>File name</span>
                    <span class="required">*</span>
                    <input id="moviefilename" type="text" readonly></input>
                </div>
                <div class="metaitem">
                    <span>OSDb Hash</span>
                    <span class="required">*</span>
                    <input id="moviehash" type="text" readonly></input>
                </div>
                <div class="metaitem">
                    <span>Size (in bytes)</span>
                    <span class="required">*</span>
                    <input id="moviebytesize" type="text" readonly></input>
                </div>
                <div class="metaitem">
                    <span>IMDB id</span>
                    <input id="imdbid" type="text"></input>
                    <span class="search-imdb" onClick="interface.searchPopup()">search</span>
                </div>
                <div class="metaitem">
                    <span>High definition</span>
                    <input id="highdefinition" type="checkbox"></input>
                </div>
            </div>

            <div class="content col-right">
                <div class="metaitem">
                    <span>Movie AKA</span>
                    <input id="movieaka" type="text"></input>
                </div>
                <div class="metaitem">
                    <span>Release name</span>
                    <input id="moviereleasename" type="text"></input>
                </div>
                <div class="metaitem">
                    <span>FPS</span>
                    <input id="moviefps" type="text"></input>
                </div>
                <div class="metaitem">
                    <span>Total time (in ms)</span>
                    <input id="movietimems" type="text"></input>
                </div>
                <div class="metaitem">
                    <span>Number of frames</span>
                    <input id="movieframes" type="text"></input>
                </div>
            </div>
        </div>
    </section>

    <section id="main-subtitle" class="section-file">

        <div class="input-line">
            <span class="input-file">Subtitle file</span>
            <input id="subtitle-file-path" class="input-input" type="text" placeholder="Drop a subtitle file or select one" readonly></input>
            <input id="subtitle-file-path-hidden" style="display:none" type="file"></input>
            <div id="subtitle-browser" onClick="interface.browse('subtitle')" class="button light">browse</div>
        </div>

        <div class="metadata">
            <span class="title">Metadata</span>
            <div class="content col-left">
                <div class="metaitem">
                    <span>File name</span>
                    <span class="required">*</span>
                    <input id="subfilename" type="text" readonly></input>
                </div>
                <div class="metaitem">
                    <span>MD5 Hash</span>
                    <span class="required">*</span>
                    <input id="subhash" type="text" readonly></input>
                </div>
                <div class="metaitem">
                    <span>Language</span>
                    <select id="sublanguageid" name="language" selected="">
                        <option value="">None</option>
                    </select>
                    <span class="detect-lang" onClick="misc.detect_lang()">detect</span>
                    <script>
                        var os_langs = require('./js/os-lang.json');

                        var langs = '';
                        for(var key in os_langs) {
                            langs += '<option value="'+os_langs[key].code+'">'+key+'</option>';
                        }
                        $('#sublanguageid').append(langs);
                    </script>
                </div>
            </div>

            <div class="content col-right">
                <div class="metaitem">
                    <span>Hearing impaired</span>
                    <input id="hearingimpaired" type="checkbox"></input>
                </div>
                <div class="metaitem">
                    <span>Auto-translated</span>
                    <input id="automatictranslation" type="checkbox"></input>
                </div>
            </div>

            <div class="content col-both">
                <div class="metaitem">
                    <span>Comment</span>
                    <input id="subauthorcomment" type="text"></input>
                </div>
            </div>
        </div>
    </section>
    <span class="special-required">* required</span>

    <div class="app-author">v%appversion% - developped by <a href="https://github.com/vankasteelj" target="_blank">vankasteelj</a></div>

    <section id="search-popup">
        <div id="search">
            <input id="search-text" type="text" placeholder="Enter a title"></input>
            <div id="button-search" onClick="opensubtitles.search_imdb()" class="button light">search</div>
            <div id="search-result"></div>
        </div>
    </section>

    <script>
        document.addEventListener("keypress", function (key) {
            if(key.ctrlKey && key.charCode === 4) {
                gui.Window.get().showDevTools()
            } else if (key.ctrlKey && key.charCode === 18) {
                var argv = gui.App.fullArgv,
                CWD = process.cwd();

                argv.push(CWD);
                require('child_process').spawn(process.execPath, argv, {
                    cwd: CWD,
                    detached: true,
                    stdio: ['ignore', 'ignore', 'ignore']
                }).unref();
                gui.App.quit();
            }
        });

        $('#video-file-path-hidden').attr('accept', misc.supportedTypes.video.join());
        $('#subtitle-file-path-hidden').attr('accept', misc.supportedTypes.subtitle.join());

        interface.check_visible();
        opensubtitles.verify_login();
        $('.app-author').html($('.app-author').html().replace('%appversion%', require('../package.json').version));

        win.show();
    </script>
</body>

</html>